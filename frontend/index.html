<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Unearthed</title>
    <link href="css/bootstrap.min.css" media="all" rel="stylesheet" type="text/css">
    <link href="css/style.css" media="all" rel="stylesheet" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script type="text/javascript">

        var Sample_Form_Template;
        var APIUrl = "http://ec2-54-206-23-214.ap-southeast-2.compute.amazonaws.com:3000/api/";

        function changePage(page) {
            $(".page").removeClass("active");
            $(".page[page_id='"+page+"']").addClass("active");
        }

        $(document).ready(function() {
            Sample_Form_Template = $("#Sample_Form_List group").clone();
            console.log(Sample_Form_Template);
        });

        function getSampleID(callback){
            $.ajax({
                url: APIUrl + "sample/id",
            }).done(function(url) {
                if(url.status == 200) {
                    return callback(url.response);
                }
                return false;
            });
        }

        function setMostRecentSampleID() {
            var data = getSampleID(function(data){
                if(data !== false){
                    console.log(data.id)
                } else {
                    console.log("Get Sample ID Failed");
                }
            });
           // $("#Sample_Form_List:last-child group input[ajax_name='id']").val(getSampleID().response.id);
        }

        //Drum data
        $.fn.serializeObject = function() {
            var o = {};
            var a = this.serializeArray();
            $.each(a, function() {
                if (o[this.name] !== undefined) {
                    if (!o[this.name].push) {
                        o[this.name] = [o[this.name]];
                    }
                    o[this.name].push(this.placeholder || '');
                } else {
                    o[this.name] = this.placeholder || '';
                }
            });
            return o;
        };

        //return drum data
        $(function() {
            $('form').submit(function() {
                var drumData = JSON.stringify($('form').serializeObject());
                console.log(drumData);
            });
        });

        function addSample(){
            $("#Sample_Form_List").append($(Sample_Form_Template).clone());
            console.log(Sample_Form_Template);
        }

        //get extra info
        $.getJSON('http://ipinfo.io', function(data){
            console.log(data);
        })
    </script>
</head>
<body>
    <div class="page-header-nav">
        <div class="container-fluid">
            <div class="row">
                <div class="col-xs-6">
                    <h1 class="Title">Dashboard</h1>
                </div>
                <div class="col-xs-6">
                    <a href="#" onclick="changePage(2)" class="btn btn-default btn-primary barrel-button">New Barrel</a>
                </div>
            </div>
        </div>
    </div>
    <div class="page-container">
        <div class="page-content">
            <div class="sidebar">
                <h4>Select a Barrel</h4>
                <ul class="barrel-select">
                    <a href="#"><li class="active">AU0ADS9G</li></a>
                    <a href="#"><li>PJKADSHS</li></a>
                    <a href="#"><li>BU0ACS9G</li></a>
                    <a href="#"><li>IU0ABS8H</li></a>
                    <a href="#"><li>AY0ADS9F</li></a>
                    <a href="#"><li>VU0AHS6G</li></a>
                    <a href="#"><li>A90AOS9D</li></a>
                    <a href="#"><li>AU0AFD5A</li></a>
                    <a href="#"><li>G20ADS4G</li></a>
                    <a href="#"><li>HU0ADS1E</li></a>
                    <a href="#"><li>T60ADT9G</li></a>
                    <a href="#"><li>AU0ADJ7G</li></a>
                </ul>
            </div>
            <div page_id="1" class="page active content-wrapper">
                <div class="content-header">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-xs-1">
                                <a href="#">
                                    <i class="back glyphicon glyphicon-circle-arrow-left"></i>
                                </a>
                            </div>
                            <div class="col-xs-11">
                                <h4 class="barrel-title"><b>Barrel ID:</b> AU0ADS9G</h4>
                            </div>
                         </div>
                    </div>
                </div>
            </div>
            <div page_id="2" class="page content-wrapper">
                <form id="add-barrel" action="" method="POST">
                    <h4>New Barrel</h4>
                    <input name="drumID" type="hidden">
                    <div class="row">
                        <div class="col-xs-12">
                            <label>Place</label>
                            <input name="drumPlace" type="text" placeholder="e.g. Bore Location">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <label>Time</label>
                            <input name="drumTime" type="text" placeholder="i.e. The time core was removed">
                        </div>
                        <div class="col-sm-6">
                            <label>Dispatched By</label>
                            <input name="drumDispatcher" type="text" placeholder="e.g. John Smith">
                        </div>
                    </div>
                    <div id="Samples_Form" class="row">
                        <div class="col-xs-12">
                            <div class="row">
                                <div class="col-xs-6">
                                    <h5>Samples</h5>
                                </div>
                                <div class="col-xs-6">
                                    <div class="Sample_Form_Controls">
                                        <a class="btn btn-success" onclick="addSample()">+</a>
                                        <a class="btn btn-danger">-</a>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div id="Sample_Form_List" class="col-xs-12">
                                    <group class="row">
                                        <div class="col-sm-2">
                                            <input ajax_name="id" type="text" disabled placeholder="" value="">
                                        </div>
                                        <div class="col-sm-2">
                                            <input ajax_name="depth_min" type="text" placeholder="Depth Min" value="">
                                        </div>
                                        <div class="col-sm-2">
                                            <input ajax_name="depth_max" type="text" placeholder="Depth Max" value="">
                                        </div>
                                        <div class="col-sm-3">
                                            <input ajax_name="time_dug" type="text" placeholder="Time Dug" value="">
                                        </div>
                                        <div class="col-sm-3">
                                            <input ajax_name="location" type="text" placeholder="Location" value="">
                                        </div>
                                    </group>
                                </div>
                            </div>
                        </div>
                    </div>
                    <input id="submit" type="submit">
                </form>
            </div>
        </div>
    </div>
</body>
</html>